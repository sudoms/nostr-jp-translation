# NIP-09: イベント削除

`draft` `optional` `author:scsibug`

「削除」を意味する kind `5` の特別なイベントは、
1 つ以上の `e` タグをリストにまとめた形で含むものとして定義される。
`e` タグそれぞれが、作成者が削除を要求しているイベントを参照している。

各タグエントリには、削除用の `e` イベント ID を含まねばならない。

この種のイベントの `content` フィールドには、削除の理由を説明するテキスト注記を含んでいてもよい。

例えば、

```JSON
{
  "kind": 5,
  "pubkey": <32-bytes hex-encoded public key of the event creator>,
  "tags": [
    ["e", "dcd59..464a2"],
    ["e", "968c5..ad7a4"],
  ],
  "content": "these posts were published by accident",
  ...other fields
}
```

リレーは、削除リクエストにあるものと等しい `pubkey` で参照されているイベントについて、
削除するか公開を停止するべきである。
クライアントは、参照されたイベントを非表示にするか、削除ステータスを表示すべきである。

削除対象のイベントがすでにクライアントに渡っている可能性があるため、
リレーは、無期限に削除イベントを公開/共有し続けるべきである。
さらにクライアントは、削除イベントを持っていない他のリレーに、この削除イベントをブロードキャストすべきである。

## クライアントの慣行

クライアントの選択肢として、有効な削除イベントによって参照される全イベントを、完全に非表示にすることもできる。
これにはテキストノート、ダイレクトメッセージ、またはその他の未定義のイベントの種類が含まれる。
あるいはイベント自体は表示しつつ、作成者がこれを「否認」したことを示すアイコンまたは、その他の表示を付加する選択肢もある。
削除されたイベント自体のコンテンツを、`content` フィールドの内容で置き換えることも可能であるが、
元のコンテンツではなく削除理由がここに示されていることが、ユーザーインターフェイス上に明記されるべきである。

クライアントは、イベントを非表示または削除する前に、削除リクエストの `e` タグで参照されている各イベントの `pubkey` が、
削除リクエストにある `pubkey` と同一であることを必ず検証せねばならない。
この検証をリレー側で実行することは基本的にはできず、
（クライアントはリレーの判断を）信頼できるものとして扱うべきではない。

削除イベント自体を全く表示しない、目立つように通知する等の表示方法は、クライアントに委ねられている。

## リレーの慣行

リレーは削除イベントが、そのリクエストに含まれるものと同じ `pubkey` を持つイベントのみを参照していることを、検証してもよい。
しかしながらリレーは、削除リクエストから参照されているイベント全てを認識できると限らないため、これは必須ではない。

> 訳注：「クライアント→リレーA→他のクライアント」で伝送されたイベントと、
「クライアント→リレーB→他のクライアント」で伝送されたイベントは混在しうるので、リレーが全情報を持つことは保証されない。

## 削除の取り消し

削除イベントに対しての削除イベントを公開しても効力はない。
クライアントやリレーは、「削除取り消し」機能をサポートする義務はない。
