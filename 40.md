# NIP-40: 有効期限のタイムスタンプ

`draft` `optional` `author:0xtlt`

ユーザーは、メッセージが（リレーとクライアントの各々によって）期限切れとみなされ、
ゆえにリレーにおいて削除されるべき時期を示す UNIX タイムスタンプを、`expiration` タグとして指定できる。

## 仕様

```
tag: expiration
values:
 - [UNIX timestamp in seconds]: required
```

## 例

```json
{
    "pubkey": "<pub-key>",
    "created_at": 1000000000,
    "kind": 1,
    "tags": [
      ["expiration", "1600000000"]
    ],
    "content": "このメッセージは特定のタイムスタンプで期限切れとなり、リレーから削除される。\n",
    "id": "<event-id>"
}
```

注：このタイムスタンプは `created_at` と同形式で作られるべきである。
意味としては「リレーにおいて当該メッセージが削除されるべきタイミング」を示しているものと解釈すべきである。

## クライアントの振る舞い

クライアントは `supported_nips` フィールドを用いて、リレー側の本 NIP のサポート状況を確認すべきである。
クライアントは、本 NIP をサポートしないリレーに対しては、イベントに有効期限を付して送信すべきではない。

クライアントは、有効期限が切れたイベントを無視すべきである。

> 訳注：つまり「クライアントに対しての削除要求」はされていないことに注意。

## リレーの振る舞い

リレーは、有効期限が切れたからといってメッセージを直ちに削除してはいけない。
逆にメッセージを無期限に保存することは認められるが、期限切れのイベントを保存していたとしても、
それらをクライアントに送信すべきではない。
あるリレーを通じて公開されているイベントは、仮にその有効期限が切れた場合、
リレーにおいてドロップ（訳注：つまり公開停止）されるべきである。

上記に関わらず、エフェメラルなイベントを保持する行為については、
保存有効期限のタイムスタンプは影響を及ぼさない。

## 推奨される使用例

* 臨時のお知らせ - このタグを使用して、臨時のお知らせを流すことができる。
たとえば催し事の主催者が、将来の催し事に関するアナウンスを投稿できる。

* 期間限定オファー - 企業がこのタグを利用して、一定の時間経過後に期限切れになる、
すなわち期間限定の特別なオファーを作成することもできるだろう。

## 警告

イベントは継続的にリレー上で公開されているため、第三者によってダウンロードされる可能性がある。
そのためメッセージの期限設定は、会話やその他の用途のセキュリティ機能としては役に立たないと考えるべきである。
