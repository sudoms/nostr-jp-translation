# NIP-11: リレー情報のドキュメント

`draft` `optional` `author:scsibug`

リレーは、その提供可能な機能、管理者の連絡先、および各種のサーバー属性を通知するために、
サーバーのメタデータをクライアントに提供することがある。
メタデータはリレーの websocket と同じ URI により、HTTP を介して JSON ドキュメントとして利用できる。

リレーは、`application/nostr+json` の `Accept` ヘッダーを伴う HTTP(s) リクエストを、
WebSocket のアップグレードをサポートする URI で受信したとき、以下の構造のドキュメントを返す必要がある。

```json
{
  name: <リレーを識別する文字列>,
  description: <詳細情報を含む文字列>,
  pubkey: <管理者の連絡先の公開鍵>,
  contact: <管理者の代替連絡先>,
  supported_nips: <リレーがサポートする NIP 番号を並べたリスト>,
  software: <リレーソフトウェアの URL を識別する文字列>,
  version: <バージョン識別子の文字列>
}
```

どのフィールドも省略可能であり、またクライアントの側では、理解できない追加フィールドを必ず無視しなければならない。
CORS 要求については、リレーは `Access-Control-Allow-Origin`、`Access-Control-Allow-Headers`、および `Access-Control-Allow-Methods`
の各ヘッダーを送信することにより、必ず受け入れねばならない。

## フィールドの説明

### `name`

リレーは、クライアントソフトウェアで使用する名称を `name` として選択できる。
文字列形式で、クライアント側で切り捨てられないように 30 文字以内にすべきである。

> 訳注：原文が英語なので、もちろん半角 30 文字を意味している。

### `description`

リレーの詳細に関するプレーンテキスト形式の情報は、`description` 文字列に含まれている場合がある。
ここにはマークアップ、書式設定、またはワードラップ用の改行を含めず、段落を区切る場合は単に改行文字を 2 つ続けることが推奨される。
長さ制限はない。

### `pubkey`

管理者の連絡先のリストは、Nostr のイベントと同じ形式（`secp256k1` 形式の公開鍵であれば 32 バイト 16 進数の公開鍵）で、
`pubkey` の項目に置くことができる。
連絡先がリストにまとめられている場合、（`NIP-04` で定義された）暗号化されたダイレクトメッセージを、
いずれかの推奨アドレスを用いてクライアントからシステム管理者に送ることができる。
こうしたアドレスは悪用・違法コンテンツの通報、バグレポートの取りまとめ、技術サポートのリクエストなどに用いることが想定されている。

リレー事業者は、ダイレクトメッセージに返答する義務を負うわけではない。

### `contact`

`pubkey` 同様に管理者の連絡先を知らしめる方法として、`contact` フィールドの下にリストを置くこともできる。
ただしこちらの手段よりも、 `Nostr` 公開鍵とダイレクトメッセージを使う連絡手段を、強く推奨する。
この `contact` フィールドの内容は、ユーザーに連絡手段を提供するための `mailto` ないし `https` 
等のスキームを使用した URI にする必要がある。

### `supported_nips`

Nostr プロトコルが発展するにつれて、一部の機能は、特定の `NIP` を実装するリレーでのみ利用可能になる場合がある。
この `supported_nips` フィールドは、当該リレーに実装されている `NIP` の識別子を列挙した整数配列である。
たとえば `"NIP-01"` をサポートするならば `1` が、`"NIP-09"` ならば `9` が含まれる。
クライアント側からリレーに対して、どの `NIPs` をサポートしているかを告知してもらうべきではなく、
単純にクライアント側が、未サポートのものを無視することがありえるという話である。

### `software`

リレー・サーバーの実装を、`software` 属性において提供する場合がある。
この属性が存在する場合、必ずプロジェクトのホームページへの URL でなければならない。

### `version`

リレーは、そのソフトウェアのバージョンを文字列属性として公開することが可能である。
どのような形式の文字列にするかは、リレーの実装によって定義されるものの、バージョン番号またはコミット ID の形式を推奨する。
