# nostr - Notes and Other Stuff Transmitted by Relays（リレーにより伝達される文書やその他の情報）

検閲耐性を持つグローバルな「ソーシャル」ネットワークの最終解として開発された、最も単純かつオープンなプロトコル。

信頼された中央サーバーに依存せず、ゆえに攻撃耐性を持つ。
暗号キーと署名に基づいているので、改ざんを防止できる（tamperproof）仕組みである。
P2P 技術に依存していないため、（効率的に）動作する。

このプロトコルは開発中である。 [Telegram グループへの参加はこちら](https://t.me/nostr_protocol)。

## （情報源を漁るのが面倒な人用の）動作原理のざっくりとした説明

各ユーザーはクライアントソフトを使う。ネイティブなアプリケーションでもウェブクライアントでもいい。
あなたが何かを発信したい場合、まず投稿内容（ポスト） post を書いて、あなた自身の暗号キーで署名し、
これを複数のリレー relays （他人または自身がホストするサーバーのこと）に送信する。

他のユーザーからの最新の情報を得るには、これまた複数のリレーに対して、当該ユーザーが新しい情報をポストしていないかを問い合わせる。
リレーとなるサーバーは誰でも立てられる。
リレーは誰かが送ってきたポストを受け入れ、他のユーザーからの問い合わせに応じて転送するだけの、単純極まりない構造である。
クライアント側で署名を検証するので、（取得したポストが真正であるかについて）リレーを信用する必要はない。

[Nostr を使い始める](https://github.com/vishalxl/nostr_console/discussions/31)

[Nostr クライアントの機能比較](https://github.com/vishalxl/Nostr-Clients-Features-List/blob/main/Readme.md)

[Nostr プロトコルに基づくプロジェクトのリスト](https://github.com/aljazceru/awesome-nostr)

## 他の方法がダメダメであり、このプロトコルが必要とされる理由

### Twitter が抱える問題

- 広告まみれ
- ユーザーをツイッター中毒にするための奇天烈なテクニックにかまけている
- フォローしているユーザーからの、実際の過去のフィードを表示してくれない
- アカウントがバンされることがある
- アカウントがシャドウバンされることがある
- 大量のスパム

### Mastodon と類似プログラムが抱える問題

- ユーザー ID は、サードパーティが管理するドメイン名に紐付いている

- Twitter 同様、サーバー所有者はあなたを垢バンできるし、他のサーバーをブロックするかもしれない

- サーバー間の移行がプロトコル上保証されているわけではない。
サーバー同士が友好的な関係にあり、連携している場合にのみアカウントを移すことが可能であり、さもなくばフォロワーは全て失われる。

- サーバーを運営する行為に明確なインセンティブがあるわけではないので、単に Mastodon 愛好家であったり、自分の名を冠したかっこいいドメインを所有したい等の動機を持った人々がサーバーを立てる傾向にある。個人の専制で運営されるサービスは、しばしば Twitter のような大企業の専制よりも悪い状況に陥りやすく、しかもユーザーアカウントを移して逃げ出すことすらできない。

- アマチュア的に運営されるサーバーは、しばらくすると飽きて放棄されることがある。これはユーザー全員のアカウントが失われることを意味する。

- Mastodon は大量のサーバーが乱立しやすい構造になっており、ゆえに（連合に所属している等の）他のサーバー全てに更新内容をプッシュして保存させるようなケースでは、通信負荷がヤバいことになる。

- 動画の共有を行う ActivityPub 同好者たちは、テキストと同じ方式でサーバー間で動画ファイルを受け渡すことが、まあ不可能だろうとの認識に至った。そのため ActivityPub でも、動画に関しては最初に投稿された単一インスタンス上にのみホストするようになっており、これは Nostr が取ったアプローチと似たものである。

### SSB (Secure Scuttlebutt) が抱える問題

- そこまで問題があるわけではない。Nostr 開発者も Secure Scuttlebutt の仕組みを高く評価しており、
実際に Nostr の技術基盤に採用しようとした。しかしながら、

- オープンなプロトコルにすることを想定していなかったため、極めて複雑である。
どうやら特定の問題に素早く対処するために JavaScript で書き下された、オリジナルの仕様を拡大していったらしい。
そのせいで、 JSON の署名が厳密に [_ECMA-262 6th Edition_](https://www.ecma-international.org/ecma-262/6.0/#sec-json.stringify) 
の仕様に従わねばならない等、不必要に癖が強いんじゃ。

- 単一ユーザーからの更新を 1 本のチェーンとして保持することに固執している。これはデータを肥大化させ硬直性を生むため、
不必要な仕様に思える。各サーバー/ユーザーは、一連の投稿を全て保存しておかないと新しいポストが有効であることを確認できない。
Secure Scuttlebutt の開発者は必要だと判断したのだろうが、なぜそうまでする理由があるのか？

- そもそも P2P での同期を目的として開発され、"pubs" としての機能を後付けされたため、Nostr ほど単純にできていない。

- それでも、Nostr 独自プロトコルの代わりに Secure Scuttlebutt を採用し、クライアント - リレーサーバーのモデルに適応させる、
というアイデアには検討の余地がある。なぜなら標準を再利用することは常に、新しい標準を採用しようとするよりも優れているからだ。

### 全ユーザーに自前サーバーを立てさせるような方策が抱える問題

- 全員が自前でサーバーを持てばいいんじゃないかという考えもある。

- その場合もドメインそのものが検閲されてしまえば、人々は検閲に晒されることになる。

## Nostr はどのように機能しているのか？

- Nostr には 2 つの要素、 __clients__ と __relays__ がある。クライアントは全ユーザーが使うものであり、リレーは必須ではないが誰でも立てられる。

- 全てのユーザーは暗号の公開鍵によって一意に識別される。各ユーザーが行う全投稿がこの鍵で署名されており、クライアントは署名を用いて、投稿が実際にそのユーザーから行われたものであることを検証する。

- クライアントが Nostr のネットワークから情報を取得したり、投稿を公開したりするときは、予め選んでおいた幾つかのリレーと通信を行う。
リレー間での通信は行わず、ユーザーとのみ直接つながっている。

- たとえば他のユーザーの誰かを「フォロー」するという行為は単純に、自分が動かしているクライアントソフトからリレーに対して、
フォローしたいユーザーの公開鍵で署名された投稿を関知しているか否か、問い合わせるだけのことである。

- クライアントを起動するたびに、こちらがフォローしているユーザーについて関知しているリレー全てからのデータ（例えば前回起動後の全ての更新）が照会される。クライアントはこれらのデータを時系列順に整理し表示する。

- 「投稿 post」には原理上、あらゆる種類の構造化されたデータ形式が含まれうる。
ただし最も頻繁に使用されるデータ形式が Nostr の標準に組み込まれるため、これに準拠する全てのクライアントとリレーならば、
シームレスに処理できる。


## これまで挙げてきた他のネットワークが対処できない問題を、Nostr はどうやって解決しているのか？

**ユーザーアカウント凍結やサーバー閉鎖の恐れに対して**

- たしかにリレー側は、ユーザーがそこで何かを公開することをブロックできる。しかし同時に他のリレーにも公開されるので問題ない。
一箇所のリレーで垢バンされても、それによって ID とフォロワーを失うわけではない。

- 新しいリレーのアドレスを、クライアントに手動で入力する必要はない（もちろん手動入力も可能であるべきだが）。
あなたがフォローしているユーザーの誰かが、リレーとして使用したい推奨サーバーを投稿したときに、あなたのクライアントソフトが使用する
リレーのリストに、そのサーバーが自動的に追記されるべきである。

- もしもユーザーが投稿のために現在利用しているリレーを、別のリレーに変更したい場合は、新たに推奨するサーバーを現在のリレー上で公開することによって移行可能である。

- 仮に複数のリレーから同時に凍結されて、新たな推奨サーバーをブロードキャストできなくなった場合でも、他の友人を通じて移行すべき推奨サーバーをお知らせすることは可能である。友人が新しいサーバーにその推奨事項を公開することで（訳注：自分が新しいリレーを見つけて登録してもいいが）、徐々にフォロワーベースが、新しいリレーからの投稿を見つけられるようになる。

- これらの解決法はアカウント凍結への対処のみならず、リレーサーバーが停止した場合にも有効である。

**検閲耐性**

- 各ユーザーは自分の更新情報を、任意の数のリレーに向けて公開できる。

- リレーはユーザーから掲載料を取ることができる（料金のネゴシエーション機能そのものは、今の所はプロトコルに含まれていない）。
これにより検閲耐性が保証されている（お金さえ払えばあなたの投稿を掲載してくれるロシアのサーバーが常に存在しているようである）。

**スパム**

- スパムがリレーにとっての懸念事項である場合、掲載にあたっての支払いの要求、メールアドレスや電話番号等による認証等の手段をとり、
これらの認証情報をシステム内で公開鍵に紐付けてから、リレーに情報を公開することが可能である。
ハッシュキャッシュやキャプチャといった、それ以外の耐スパム技術を使用することもできる。
逆にリレーがスパムの伝達媒体になってしまった場合も、クライアント側でリストから外して他のリレーから更新を取得すればいい。

**データストレージ**

- ネットワークの健全性を維持するために、アクティブなリレーを何百箇所も用意する必要はない。
既存のリレーが誤動作し始めたとしても、新しいリレーを作成してネットワーク全体に容易に展開できるという事実を鑑みると、
ほんの一握りのリレーで問題なく機能するだろう。
したがって必要なデータストレージの数は一般に、Mastodon や類似のソフトウェアと比べて少数で済む。

- 別の帰結を考えてみよう。アマチュアが運営する何百ものニッチなリレーが存在し、その各々は、
少数で構成されるユーザーグループからの更新をリレーしている。この場合、アーキテクチャも同様にスケーリングする。
データはユーザーから単一のサーバーに送信され、そこから直接、受け手のユーザーに送信される。別の誰かが保管する必要はない。
この状況で、各々のサーバーが他のユーザーから受信した更新を処理することは大きな負荷とはならないため、
アマチュアサーバーを使用しても問題とはならない。

> 訳注：このユーザーコミュニティで偶々、インフルエンサーが爆誕したり大炎上したりした場合、
そいつのポストを読みたいユーザーからのリクエストが殺到するため、一時的にサーバーの処理能力が足りなくなる可能性はある。
ただしリレーを増やして負荷を分散することは可能であり、継続的には問題とならないだろう。

**ビデオその他の重いコンテンツ**

- リレー側で大容量のコンテンツを拒否したり、データの受け入れにあたって料金を請求したりする仕組みさえあれば、この点は解決する。
情報とインセンティブが明確であれば、市場の力でどうとでもなる問題である。

**ユーザーをだますテクニック**

- 投稿をユーザーにとって最適に表示する方法は、各クライアントに任せられている。自分がどのように情報を消費するかは好きに決めればいい。
AI で表示順を決めることも可能だし、日時順に並べてもいい。


## FAQ

- **超イージーな解決法に思えるが、なぜ誰も思いつかなかったのか？**

    わからん。とはいえソーシャル・ネットワークの作者は、お金を稼ぎたい企業か、
    サーバーに頼ることなくモノを作りたい P2P 活動家に大別されるという事実に関係していると思う。
    彼らはいずれも、Nostr が用いているところの 2 者の組み合わせには至らなかっただろう
    （訳注：SNS を通じてユーザーを囲い込みたい運営企業は、ユーザーが複数のリレーに情報を拡散できるというアイデアを嫌がるし、
    逆に P2P 前提で開発を進める人はリレーサーバーを採用したがらない）。

- **フォローしたい相手をどうやって見つけるのか？**

    まず誰かに尋ねるなり、どこかで言及されているところを見つけるなりして、フォローする相手を探しその公開鍵を入手する必要がある。

   Nostr のソーシャル・ネットワークに参加すれば、参加者同士がやり取りしているのを見て彼らをフォローし、交流を開始できる。
- **リレーを見つける方法は？他の誰かと同じリレーに接続していない場合はどうなる？**

    その相手とは通信できなくなる。とはいえあなたが用いているクライアントツールが（もしくはあなた自身が手動で）
    相手と同じリレーに接続し、交流できるようにするために利用しうるイベントについてはヒントがある。
    この問題を将来的に解消する方法については他にも幾つかのアイデアが存在しているが、
    完全な到達可能性を約束するものではない（どのようなプロトコルにも不可能である）。

- **自分のフォロワー数を知ることは可能か？**

   （Nostr の仕様内では）できない。ただし、リレーがプロトコル外の手段で協力してくれるならば、ある程度の見積もりが可能。

- **リレーを実行するインセンティブは？**

    この質問は、リレーは人々がデータを移送するにあたり、タダで利用可能な土管であると想定しているが故に、誤解を招くものとなっている。
    この想定にイエスと答えると確かにインセンティブは存在しなくなってしまうのだが、それは他の全ての P2P ネットワークにおける、
    DHT（分散ハッシュテーブル）ノードについても言えることだ。
    現に存在している DHT ノードについて、人々がそれを実行するインセンティブが何であるか、改めて考えてほしい。

- **Nostr のユーザーはリレーを変えたり、複数のリレーを投稿に利用したりできるが、これらのリレーが全て AWS ないし Azure だけに置かれていたら結局意味がないのでは？**

   現在、AWS や Azure だけでなく、文字通り何千もの VPS プロバイダーが世界中に散らばっている。スケール性が必要とされる、単一の集権化されたサービスを提供しようとした場合、選択肢は AWS と Azure に限られる。しかし小規模なリレーサーバーを運営するだけならば、それ以外の VPS サービスでも十分に機能する。


## プロトコル仕様

プロトコルは [NIPs](https://github.com/nostr-protocol/nips) にある。
とりわけ [NIP-01](https://github.com/nostr-protocol/nips/blob/master/01.md) には、いい感じにまとまったスペックの説明がある
（とても短くて読みやすい！）。

## ソフトウェア

[Nostr の基盤上に構築されたソフトウェアのほぼ完全なリスト](https://github.com/aljazceru/awesome-nostr )。


## ライセンス

パブリックドメインで提供されている。

> 訳注：ここではこの文書のライセンスを指しているが、
実際には NIPs のリポジトリに記載されているように Nostr Protocol 自体もパブリックドメインである。


----

> ここから訳者が付け足した情報

# 追加情報

* [現在実行中の Nostr リレーのリスト（リアルタイム更新）](https://nostr-registry.netlify.app/)
