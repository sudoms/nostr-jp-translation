# NIP-08: メンションの取扱い

`final` `optional` `author:fiatjaf` `author:scsibug`

このドキュメントは `text_note` のコンテンツ中で、
他のイベントや公開鍵（＝ユーザー）に対してインラインで行われるメンションについて、
クライアントがそれを処理する手順を標準化するものである。

タグ付けされたメンションを許可したいクライアントは、ユーザーがメンションをメッセージに含めるために "@" などの特殊キーを打鍵するか、あるいはそれ用のボタン等を押した場合には、オートコンプリート画面やそれに類するものを表示せねばならない。
さもなくば、メンションと通常のテキストが明確に区別されるような、別の手立てを講じる必要がある。

たとえば `27866e9d854c78ae625b867eefdfa9580434bc3e675be08d2acb526610d96fbe` 
といった公開鍵へのメンションが識別されると、クライアントはその公開鍵を `.tags` 内へタグ `p` を付けて追加し、
次いでテキスト内（`.content` 内）での参照を ` #[index]` に置換せねばならない。
この "index" は、タグ配列内の関連するタグにおける、0 から始まるインデックスに等しい。

同じプロセスは、イベント ID を用いたメンションにも適用される。

受信した `text_note` イベントの `.content` に、そのような `#[index]` によるメンションが含まれる場合、
クライアントは `.tags` 配列にあるコンテンツを検索し、
メンション対象である実際の公開鍵またはイベント ID に置換することで、
コンテクスト（たとえば公開鍵へのリンク、メンションされたイベントのコンテンツのプレビュー表示）
を必要に応じて拡張することができる。
